openapi: 3.0.0
info:
  title: cardAcceptors
  version: '1.0'
  description: A backend service to enable a cloud orchestrated Terminal solution for POS systems
  contact:
    name: Salt Group
servers:
  - url: 'http://localhost:3100'
paths:
  /card_acceptors:
    post:
      summary: Create card acceptor auth account
      operationId: createCardAcceptorAuthAccount
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CardAcceptorCreateResponse'
      description: Each card acceptor created within the portal will require system credentials that APIs may use to authenticate on behalf of the card acceptor. The credentials are created in Fusion Auth with a preset creation definition.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                mid:
                  type: string
                acquirer:
                  type: string
                switchAccessToken:
                  type: string
                name:
                  type: string
              required:
                - mid
                - acquirer
                - name
        description: MID for the card acceptor auth account being created
      tags:
        - admin
    parameters: []
  '/card_acceptors/{cardAcceptorGuid}/manager_pin':
    parameters:
      - schema:
          type: string
        name: cardAcceptorGuid
        in: path
        required: true
    post:
      summary: Set Manager Pin
      operationId: setCardAcceptorManagerPin
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                  message:
                    type: string
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties: {}
      tags:
        - terminal
      description: Set the pin for a card acceptor
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                managerPinData:
                  type: string
              required:
                - managerPinData
      security:
        - Authorization: []
    put:
      summary: Update Manager Pin
      operationId: updateCardAcceptorManagerPin
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                  message:
                    type: string
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                  message:
                    type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                managerPinData:
                  type: string
      parameters:
        - schema:
            type: string
          in: header
          name: x-managerPinData
          description: ''
      description: Update the pin for a specific card acceptor
      tags:
        - admin
  '/card_acceptors/{cardAcceptorGuid}':
    parameters:
      - schema:
          type: string
        name: cardAcceptorGuid
        in: path
        required: true
    patch:
      summary: Update Card Acceptor
      operationId: updateCardAcceptor
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CardAcceptorDetailsResponse'
        '404':
          description: Card Acceptor Not Found
          content:
            application/json:
              schema:
                $ref: './terminals.v1.yaml#/components/schemas/ApiResponse'
      description: 'Update the card acceptor record with latest details needed by the terminal. This includes the optional Loyalty Program details. If Loyalty Program details are provided, this call will operate within a transaction, during which it will also call the Loyalty Gateway service to update its Card Acceptor with the Loyalty Program linked to the Card Acceptor. If this call fails, the change will be rolled back.'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                switchAccessToken:
                  type: string
                name:
                  type: string
                loyaltyProgramGuid:
                  type: string
                loyaltyAccessToken:
                  type: string
      tags:
        - admin
components:
  schemas:
    CardAcceptorDetails:
      title: CardAcceptorDetails
      type: object
      description: Object describing the full set of details available for a card acceptor. The actual set will depend on what is avaiable at the time and may be dependent on the caller.
      properties:
        cardAcceptorGuid:
          type: string
        acquirer:
          type: string
        mid:
          type: string
        name:
          type: string
        managerPinSet:
          type: boolean
        switchAccessToken:
          type: string
        posGuid:
          type: string
        loyaltyProgramGuid:
          type: string
        state:
          type: string
    CardAcceptorCreateDetails:
      title: CardAcceptorCreateDetails
      type: object
      description: Object describing the set of details available for a card acceptor after creation.
      properties:
        cardAcceptorGuid:
          type: string
      required:
        - cardAcceptorGuid
    CardAcceptorDetailsResponse:
      title: CardAcceptorDetailsResponse
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
        cardAcceptorDetails:
          $ref: '#/components/schemas/CardAcceptorDetails'
    CardAcceptorCreateResponse:
      title: CardAcceptorCreateResponse
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
        cardAcceptorDetails:
          $ref: '#/components/schemas/CardAcceptorCreateDetails'
  securitySchemes:
    Authorization:
      type: http
      scheme: bearer
      description: ''
tags:
  - name: cardAcceptor
    description: Administer the card acceptors managed by the service
    externalDocs:
      url: 'http://terminals.somewhere.com/admin.htm'
  - name: admin
    description: Administer the terminals managed by the service
    externalDocs:
      url: 'http://terminals.somewhere.com/admin.htm'
  - name: pos
    description: Methods available to POS systems
    externalDocs:
      url: 'http://terminals.somewhere.com/pos.htm'
  - name: terminal
    description: Methods available to terminals
    externalDocs:
      url: 'http://terminals.somewhere.com/terminals.htm'
  - name: model
    description: Data models used by the API
    externalDocs:
      url: 'http://terminals.somewhere.com/models.htm'
